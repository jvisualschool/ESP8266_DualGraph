<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESP8266 Graph Gallery v3.0 Turbo - Preview</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0a0a0a;
    color: #fff;
    font-family: 'Courier New', monospace;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 40px 20px;
  }

  h1 {
    font-size: 1.6rem;
    color: #00ffff;
    margin-bottom: 8px;
    font-weight: bold;
    letter-spacing: 2px;
    text-shadow: 0 0 10px rgba(0,255,255,0.5);
  }

  .subtitle {
    color: #555;
    font-size: 0.9rem;
    margin-bottom: 30px;
  }

  .displays {
    display: flex;
    gap: 40px;
    align-items: flex-start;
    flex-wrap: wrap;
    justify-content: center;
  }

  .display-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  .display-label {
    color: #555;
    font-size: 0.75rem;
    letter-spacing: 1px;
  }

  /* TFT 240x240 */
  .tft-frame {
    width: 280px;
    height: 280px;
    background: #000;
    border: 3px solid #333;
    border-radius: 8px;
    padding: 20px;
    position: relative;
    box-shadow: 0 0 40px rgba(0,0,0,1), inset 0 0 20px rgba(0,0,0,0.5);
  }

  .tft-screen {
    width: 240px;
    height: 240px;
    background: #000;
    position: relative;
    overflow: hidden;
    image-rendering: pixelated;
  }

  /* OLED 128x64 */
  .oled-frame {
    width: 200px;
    height: 120px;
    background: #111;
    border: 3px solid #222;
    border-radius: 6px;
    padding: 12px 36px;
    box-shadow: 0 0 20px rgba(0,0,0,0.8);
  }

  .oled-screen {
    width: 128px;
    height: 64px;
    background: #000;
    position: relative;
    overflow: hidden;
    border: 1px solid #1a1a1a;
  }

  .oled-screen .oled-divider {
    border-top: 1px solid #cde6ff;
    margin: 2px 0;
  }

  .oled-graph-num { font-size: 8px; color: #cde6ff; }
  .oled-graph-name { font-size: 14px; color: #cde6ff; font-weight: bold; margin: 2px 0; }
  .oled-graph-desc { font-size: 8px; color: #cde6ff; line-height: 1.5; }

  /* ===== Timer ===== */
  .timer-bar {
    width: 400px;
    max-width: 90vw;
    margin-top: 30px;
    text-align: center;
  }

  .timer-track {
    width: 100%;
    height: 6px;
    background: #1a1a1a;
    border-radius: 3px;
    overflow: hidden;
    margin-top: 8px;
  }

  .timer-fill {
    height: 100%;
    background: linear-gradient(90deg, #ff00ff, #00ffff);
    transition: width 0.1s linear;
  }

  /* ===== Graph nav ===== */
  .graph-nav {
    display: flex;
    gap: 8px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 800px;
  }

  .graph-nav-btn {
    padding: 6px 12px;
    background: #111;
    border: 1px solid #333;
    border-radius: 4px;
    color: #666;
    cursor: pointer;
    font-size: 0.75rem;
    transition: all 0.2s;
  }

  .graph-nav-btn.active {
    background: #004444;
    border-color: #00ffff;
    color: #fff;
    box-shadow: 0 0 10px rgba(0,255,255,0.2);
  }

  .hardware-info {
    margin-top: 40px;
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
  }

  .hw-card {
    background: #111;
    border: 1px solid #222;
    border-radius: 8px;
    padding: 16px 20px;
    min-width: 220px;
  }

  .hw-card h3 { color: #888; font-size: 0.75rem; text-transform: uppercase; margin-bottom: 12px; }
  .hw-row { display: flex; justify-content: space-between; padding: 4px 0; font-size: 0.85rem; }
  .hw-label { color: #555; }
  .hw-value { color: #aaa; }
</style>
</head>
<body>

<h1>ESP8266 DUALGRAPH v3.0 TURBO</h1>
<p class="subtitle">ST7789 TFT + SSD1306 OLED Visualization</p>

<div class="graph-nav" id="graph-nav"></div>

<div class="displays">
  <div class="display-group">
    <div class="display-label">TFT 240x240 (Direct GPIO)</div>
    <div class="tft-frame">
      <div class="tft-screen">
        <canvas id="tft-canvas" width="240" height="240"></canvas>
      </div>
    </div>
  </div>

  <div class="display-group">
    <div class="display-label">OLED 128x64 (I2C)</div>
    <div class="oled-frame">
      <div class="oled-screen">
        <div id="oled-content" style="padding: 4px;">
          <div class="oled-graph-num" id="oled-gnum">1 / 16</div>
          <div class="oled-graph-name" id="oled-gname">Sine Wave</div>
          <div class="oled-divider"></div>
          <div class="oled-graph-desc" id="oled-gdesc1">Periodic function</div>
          <div class="oled-graph-desc" id="oled-gdesc2">y = sin(x)</div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="timer-bar">
  <div class="timer-track"><div class="timer-fill" id="timer-fill" style="width:0%"></div></div>
  <div id="timer-text" style="color:#555; font-size:0.8rem; margin-top:8px;">Initializing...</div>
</div>

<div class="hardware-info">
  <div class="hw-card">
    <h3>System</h3>
    <div class="hw-row"><span class="hw-label">CPU Clock</span><span class="hw-value" style="color:#00ff00;">160 MHz</span></div>
    <div class="hw-row"><span class="hw-label">Rendering</span><span class="hw-value">Direct GPIO Blast</span></div>
    <div class="hw-row"><span class="hw-label">MCU</span><span class="hw-value">ESP8266EX</span></div>
  </div>
  <div class="hw-card">
    <h3>Design</h3>
    <div class="hw-row"><span class="hw-label">TFT Size</span><span class="hw-value">240x240 px</span></div>
    <div class="hw-row"><span class="hw-label">Graphs</span><span class="hw-value">16 Unique Styles</span></div>
    <div class="hw-row"><span class="hw-label">Theme</span><span class="hw-value">Cyberpunk Dots/Lines</span></div>
  </div>
</div>

<script>
const graphDefs = [
  { name: 'Sine Wave',    d1: 'Periodic function', d2: 'y = sin(x)',       steps: 150, draw: drawSineWave },
  { name: 'Bar Chart',    d1: 'Category compare',  d2: 'Bottom-up Growth', steps: 65,  draw: drawBarChart },
  { name: 'Pie Chart',    d1: 'Proportions',       d2: 'Arc segments',     steps: 40,  draw: drawPieChart },
  { name: 'Line Graph',   ... { d1: 'Trend analysis', d2: 'CPU/MEM/NET Stats', steps: 150, draw: drawLineGraph } },
  { name: 'Scatter Plot', d1: 'Correlation',        d2: 'Random Points',   steps: 55,  draw: drawScatterPlot },
  { name: 'Radar Chart',  ... { d1: 'Multi-axis', d2: 'Animated Polygon',  steps: 40,  draw: drawRadarChart } },
  { name: 'Area Chart',   d1: 'Cumulative',        d2: 'Premium Magenta',  steps: 105, draw: drawAreaChart },
  { name: 'Gauge',        d1: 'Single value',      d2: 'Needle + arc',     steps: 60,  draw: drawGauge },
  { name: 'Histogram',    d1: 'Distribution',      d2: 'Frequency bins',   steps: 65,  draw: drawHistogram },
  { name: 'Spiral',       d1: 'Archimedes',        d2: 'Geometric Motion', steps: 130, draw: drawSpiral },
  { name: 'Lissajous',    d1: 'Frequency ratio',   d2: 'Parametric XY',    steps: 150, draw: drawLissajous },
  { name: 'Rose Curve',   d1: 'Polar coords',      d2: 'r = cos(7*theta)', steps: 150, draw: drawRoseCurve },
  { name: 'Heart Curve',  d1: 'Parametric',        d2: 'Love equation',    steps: 130, draw: drawHeartCurve },
  { name: 'Vortex Dots',  d1: 'Particle swarm',    d2: 'Spiral vortex',    steps: 150, draw: drawVortexDots },
  { name: 'Moire Lines',  d1: 'Interference',      d2: 'Radial patterns',  steps: 100, draw: drawMoireLines },
  { name: 'System Info',  d1: 'Hardware specs',    d2: 'ESP8266 Stats',    steps: 1,   draw: drawSystemInfo, hold: 7000 }
];

// Re-adjust Line Graph entry structure
graphDefs[3] = { name: 'Line Graph', d1: 'Trend analysis', d2: 'CPU/MEM/NET Stats', steps: 150, draw: drawLineGraph };
graphDefs[5] = { name: 'Radar Chart', d1: 'Multi-axis', d2: 'Animated Polygon', steps: 40, draw: drawRadarChart };

let canvas = document.getElementById('tft-canvas');
let ctx = canvas.getContext('2d');
let currentGraphIdx = 0;
let currentStep = 0;
let data = {};

function init() {
  const nav = document.getElementById('graph-nav');
  graphDefs.forEach((g, i) => {
    const btn = document.createElement('button');
    btn.className = 'graph-nav-btn' + (i === 0 ? ' active' : '');
    btn.textContent = (i + 1) + '. ' + g.name;
    btn.onclick = () => { currentGraphIdx = i; resetGraph(); };
    nav.appendChild(btn);
  });
  resetGraph();
}

function resetGraph() {
  currentStep = 0;
  data = {};
  ctx.fillStyle = '#000';
  ctx.fillRect(0, 0, 240, 240);
  
  // Header
  ctx.fillStyle = '#222';
  ctx.fillRect(0, 0, 240, 24);
  ctx.fillStyle = '#00ffff';
  ctx.font = 'bold 14px Courier New';
  ctx.fillText(graphDefs[currentGraphIdx].name, 10, 18);

  const navBtns = document.querySelectorAll('.graph-nav-btn');
  navBtns.forEach((btn, i) => btn.className = 'graph-nav-btn' + (i === currentGraphIdx ? ' active' : ''));

  document.getElementById('oled-gnum').textContent = (currentGraphIdx + 1) + ' / ' + graphDefs.length;
  document.getElementById('oled-gname').textContent = graphDefs[currentGraphIdx].name;
  document.getElementById('oled-gdesc1').textContent = graphDefs[currentGraphIdx].d1;
  document.getElementById('oled-gdesc2').textContent = graphDefs[currentGraphIdx].d2;
  
  graphDefs[currentGraphIdx].draw('init');
  requestAnimationFrame(loop);
}

function loop() {
  const g = graphDefs[currentGraphIdx];
  if (currentStep < g.steps) {
    g.draw(currentStep);
    currentStep++;
    
    // Maintain Title Bar
    ctx.fillStyle = '#222'; ctx.fillRect(0, 0, 240, 24);
    ctx.fillStyle = '#00ffff'; ctx.font = 'bold 14px Courier New';
    ctx.fillText(g.name, 10, 18);

    document.getElementById('timer-fill').style.width = (currentStep / g.steps * 100) + '%';
    document.getElementById('timer-text').textContent = `Rendering ${g.name}...`;
    requestAnimationFrame(loop);
  } else {
    document.getElementById('timer-fill').style.width = '100%';
    document.getElementById('timer-text').textContent = `Holding for ${g.hold ? g.hold/1000 : 2}s...`;
    setTimeout(() => {
      currentGraphIdx = (currentGraphIdx + 1) % graphDefs.length;
      resetGraph();
    }, g.hold || 2000);
  }
}

// Drawing Helpers
function drawAxes(x, y, w, h) {
  ctx.strokeStyle = '#444'; ctx.lineWidth = 1;
  ctx.beginPath(); ctx.moveTo(x, y - h); ctx.lineTo(x, y); ctx.lineTo(x + w, y); ctx.stroke();
}

function drawSineWave(s) {
  if (s==='init') { drawAxes(15, 180, 210, 130); return; }
  let x = s * (4 * Math.PI) / 150;
  let py = 115 - Math.sin(x) * 60;
  ctx.fillStyle = '#0f0'; ctx.beginPath(); ctx.arc(16 + s * 1.4, py, 2, 0, 6.28); ctx.fill();
}

function drawBarChart(s) {
  const vals = [75, 45, 90, 60, 85];
  const colors = ['#f00', '#0f0', '#00f', '#f80', '#80f'];
  if (s==='init') { drawAxes(25, 220, 200, 180); return; }
  for (let i = 0; i < 5; i++) {
    let h = (vals[i] * 1.7) * (s / 65);
    ctx.fillStyle = colors[i];
    ctx.fillRect(30 + i * 38, 220 - h, 30, 2);
  }
}

function drawPieChart(s) {
  const slices = [30, 25, 20, 15, 10];
  const colors = ['#f00', '#f80', '#0f0', '#0ff', '#80f'];
  if (s==='init') return;
  let total = (s / 40) * 360;
  let acc = -90;
  for (let i = 0; i < 5; i++) {
    let sweep = (slices[i] / 100) * 360;
    let end = Math.min(acc + sweep, -90 + total);
    if (end > acc) {
      ctx.fillStyle = colors[i]; ctx.beginPath(); ctx.moveTo(120, 135);
      ctx.arc(120, 135, 80, acc * Math.PI/180, end * Math.PI/180);
      ctx.fill();
    }
    acc += sweep;
  }
}

function drawLineGraph(s) {
  if (s==='init') { 
    drawAxes(25, 220, 200, 180); 
    ctx.font = '10px Courier'; ctx.fillStyle = '#f00'; ctx.fillText('CPU', 170, 35);
    ctx.fillStyle = '#0f0'; ctx.fillText('MEM', 195, 35);
    ctx.fillStyle = '#0ff'; ctx.fillText('NET', 220, 35);
    return; 
  }
  let x = 26 + (s/150)*200;
  ctx.fillStyle = '#f00'; ctx.fillRect(x, 150 + Math.sin(s/10)*20, 2, 2);
  ctx.fillStyle = '#0f0'; ctx.fillRect(x, 100 + Math.cos(s/15)*30, 2, 2);
  ctx.fillStyle = '#0ff'; ctx.fillRect(x, 180 - Math.sin(s/20)*15, 2, 2);
}

function drawScatterPlot(s) {
  if (s==='init') { drawAxes(25, 220, 200, 180); return; }
  ctx.fillStyle = '#0ff'; ctx.beginPath(); 
  ctx.arc(30 + Math.random()*180, 50 + Math.random()*150, 3, 0, 6.28); ctx.fill();
}

function drawRadarChart(s) {
  if (s==='init') { drawAxes(120, 140, 80, 80); return; }
  let scale = s / 40;
  ctx.strokeStyle = '#0f0'; ctx.beginPath();
  for(let i=0; i<6; i++) {
    let a = (i*72 - 90) * Math.PI/180;
    let r = 70 * scale;
    ctx.lineTo(120 + r*Math.cos(a), 140 + r*Math.sin(a));
  }
  ctx.stroke();
}

function drawAreaChart(s) {
  if (s==='init') { drawAxes(20, 225, 210, 185); return; }
  let x = 21 + s * 2;
  let h = 50 + Math.sin(s/5)*40;
  ctx.fillStyle = '#4008'; ctx.fillRect(x, 225-h, 2, h);
  ctx.fillStyle = '#f0f'; ctx.fillRect(x, 225-h, 2, 2);
}

function drawGauge(s) {
  if (s==='init') return;
  ctx.strokeStyle = '#333'; ctx.lineWidth = 10; ctx.beginPath(); ctx.arc(120, 155, 80, Math.PI, 2*Math.PI); ctx.stroke();
  let a = Math.PI + (s/60)*Math.PI;
  ctx.strokeStyle = '#0ff'; ctx.lineWidth = 4; ctx.beginPath(); ctx.moveTo(120, 155); ctx.lineTo(120 + 70*Math.cos(a), 155 + 70*Math.sin(a)); ctx.stroke();
}

function drawHistogram(s) {
  if (s==='init') { drawAxes(20, 225, 210, 190); return; }
  for(let i=0; i<12; i++) {
    let h = (30 + i*5) * (s/65);
    ctx.fillStyle = '#00f'; ctx.fillRect(24 + i*17, 225-h, 15, 2);
  }
}

function drawSpiral(s) {
  if (s==='init') return;
  let a = (s/130) * 6 * Math.PI;
  let r = a * 4;
  ctx.fillStyle = `hsl(${s*3}, 100%, 50%)`; ctx.fillRect(120 + r*Math.cos(a), 140 + r*Math.sin(a), 3, 3);
}

function drawLissajous(s) {
  if (s==='init') return;
  let t = (s/150) * 2 * Math.PI;
  ctx.fillStyle = '#0af'; ctx.fillRect(120 + 90*Math.sin(3*t), 135 + 80*Math.sin(2*t), 2, 2);
}

function drawRoseCurve(s) {
  if (s==='init') return;
  let t = (s/150) * 2 * Math.PI;
  let r = 90 * Math.cos(7*t);
  ctx.fillStyle = '#f0f'; ctx.fillRect(120 + r*Math.cos(t), 135 + r*Math.sin(t), 2, 2);
}

function drawHeartCurve(s) {
  if (s==='init') return;
  let t = (s/130) * 2 * Math.PI;
  let hx = 16 * Math.pow(Math.sin(t), 3);
  let hy = -(13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t));
  ctx.fillStyle = '#f00'; ctx.fillRect(120 + hx*6, 130 + hy*6, 2, 2);
}

function drawVortexDots(s) {
  if (s==='init') return;
  for(let i=0; i<8; i++) {
    let a = (s*5 + i*45) * Math.PI/180;
    let r = 10 + s*0.8;
    ctx.fillStyle = '#0ff'; ctx.fillRect(120 + r*Math.cos(a), 135 + r*Math.sin(a), 2, 2);
    ctx.fillStyle = '#f0f'; ctx.fillRect(120 + (r+5)*Math.cos(a+0.2), 135 + (r+5)*Math.sin(a+0.2), 1, 1);
  }
}

function drawMoireLines(s) {
  if (s==='init') return;
  let a = s * 3.6 * Math.PI / 180;
  ctx.strokeStyle = `rgb(${s*2}, ${255-s*2}, 255)`;
  ctx.beginPath(); ctx.moveTo(120, 135); ctx.lineTo(120 + 110*Math.cos(a), 135 + 110*Math.sin(a)); ctx.stroke();
  ctx.strokeStyle = `rgb(255, ${s*2}, ${s})`;
  ctx.beginPath(); ctx.moveTo(120, 135); ctx.lineTo(120 - 110*Math.cos(a), 135 - 110*Math.sin(a)); ctx.stroke();
}

function drawSystemInfo(s) {
  ctx.fillStyle = '#fff'; ctx.font = '16px Courier New';
  ctx.fillText("CPU:   160 MHz", 15, 75);
  ctx.fillText("Heap:  34.2 KB", 15, 110);
  ctx.fillText("Flash: 4 MB", 15, 145);
  ctx.fillText("Chip:  D8B1C7", 15, 180);
  ctx.strokeStyle = '#444'; ctx.strokeRect(8, 45, 224, 180);
}

init();
</script>
</body>
</html>
